---
title: "DSA5041 Project Vignette"
author: "Robert Hill"
date: "4/15/2022"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{DSAProjVig}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Introduction

The package `DSA5041PROJ1` runs the Student's T-Test on two populations to determine if the means are the same.

# Functions

TODO: Explain all functions once they are created.

## OOP

In this package we will be using `S3` OOP -- which is the commonly used object oriented form in R package making.

See <https://adv-r.hadley.nz/s3.html> for more information.

## Documentation

There are two forms of documentation
  
  1. Function specific using Roxygen.
  2. Vignette -- long form.
  
# Constructor

The first function is `myttest`. It runs a t-test and produces a list of useful information, including the population data, confidence interval, and the p-value.

```{r, eval=FALSE}
myconstr=function(x, y, alpha=0.05){

  ###conditionals to check arguments
  #confirming x is a numeric vector
  xClass = class(x)
  if(xClass != "numeric") {
    stop(paste0("The input x is of class ", xClass, " but must be a vector!!"))
  }
  #confirming y is a numeric vector
  yClass = class(y)
  if(yClass != "numeric") {
    stop(paste0("The input y is of class ", xClass, " but must be a vector!!"))
  }
  #confirming alpha is between 0-1
  if(alpha < 0 || alpha > 1) {
    stop(paste0("The input alpha is out of bounds. Input a value for alpha between 0 and 1"))
  }


  #declaring vectors for data and the source "v". Code from the example.
  data <- vector(mode = "numeric", length = length(x) + length(y))
  v <- vector(mode = "list", length = length(data))

  #creating dataframe
  data <- c(x,y)
  v <- rep(c("x","y"), c(length(x),length(y)))
  df = data.frame("data" = data, "v" = v)

  #running ttest

  tt<-t.test(x,y,var.equal = TRUE, conf.level=1-alpha)


  #returning a list
  returnObject = list('data' = df, 'alpha' = alpha, 'ConfidenceInt' = 1-alpha, 'pvalue'=tt$p.value)
  class(returnObject) = "Rttest"
  returnObject
}
```

Below is an example of the `myttest` function running:

```{r}
library(DSA5041PROJ1)
set.seed(21)
x <- rnorm(30,5,2)
set.seed(23)
y <- rnorm(30,3,2)
alpha <- 0.05

obj <- myttest(x=x, y=y, paired=F, alpha=alpha)
class(obj)

```

Notice that the output is of class "Rttest"

The components can then be operated on by an appropriate method attached to a generic.

# Methods

## Print

This method is attached to the generic function `print()`. It generates a formatted table of the input data with a note at the bottom that shows the confidence interval and the p-value.

```{r, eval=FALSE}
print.Rttest <- function(x, ...) {

  #though it shouldn't ever happen, the method confirms that an Rttest object is given as the argument
  stopifnot(class(x) == "Rttest")

  #generating table kable styled
  printTable <- kable(x$data, caption = "Input Data") %>%
    kable_styling("hover", full_width = F) %>%
    footnote(general = paste("Confidence Interval: ", x$ConfidenceInt, '\n',
                             "p-value: ", x$pvalue))
  printTable

}
```

We can call it by simply invoking the `print()` function

```{r}
print(obj)
```

## Plot

This method is attached to the generic function `plot()`. It generates side-by-side boxplots of the data for each population.

```{r, eval=FALSE}
plot.Rttest <- function(x, ...) {

  #though it shouldn't ever happen, the method confirms that an Rttest object is given as the argument
  stopifnot(class(x) == "Rttest")

  #generating table kable styled
  plotIt <- ggplot(x$data, aes(x=x$data[,2],y=x$data[,1],fill=x$data[,2])) +
    geom_boxplot() +
    labs(x="Population", y="Values")

  plotIt

}
```

We can call it by simply invoking the `plot()` function

```{r}
plot(obj)
```




# Shiny server

These two functions have been placed into a shiny app and can be invoked using 

```{r,eval = FALSE}
#shinyhist()
```

